nie.util.captcha=nie.util.captcha||{id:{},create:function(){var a={id:null,progress:0,loadClass:"NIE-captchaBox-loading",showCaptcha:!1,$img:function(){var a=$(new Image);a.bind("readystatechange",function(){}).bind("abort",function(){});return a},loadCapImg:function(){a.$img().click(function(){a.progress=0;a.loadCaptcha()}).load(function(){a.progress=0;$(this).appendTo(a.captchaBox)}).error(function(){a.captchaBox.removeClass(a.loadClass).text("\u5237\u65b0\u8fc7\u591a\uff0c\u8bf7\u7a0d\u5019")}).attr({src:a.getRemoteURL({file:"captcha",
params:{id:a.id}}),width:a.width,height:a.height})},loadCaptcha:function(){if(a.progress==0)a.captchaBox.empty(),a.progress=1,a.showCaptcha?a.loadCapImg():(a.showCaptcha=!0,a.captchaBox.addClass(a.loadClass),a.getRemote({file:"IdCreator",callBack:function(){a.id=nie.util.captcha.id[a.appID];a.loadCapImg()}}))},bindParams:function(a){var d=[],c;for(c in a)d.push(c+"="+a[c]);return d.join("&")},getRemoteURL:function(b){var d={appID:a.appID,ts:(new Date).getTime()};if(b.params)for(var c in b.params)d[c]=
b.params[c];return"http://captcha.nie.163.com/"+b.file+"?"+a.bindParams(d)+"&.js"},getRemote:function(b){$.include(a.getRemoteURL(b),b.callBack)}};a.init=function(){if(a.fatDOM&&a.touchDOM&&a.appID)a.width=a.width||150,a.height=a.height||45,a.fatDOM=$(a.fatDOM),a.captchaBox=a.fatDOM.find(".NIE-captchaBox"),a.captchaInput=a.fatDOM.find("input[name=NIE-captchaInput]"),a.touchDOM=$(a.touchDOM),a.touchDOM.focusin(function(){a.showCaptcha||a.loadCaptcha()})};return a}};
